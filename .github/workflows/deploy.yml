name: Deploy to GitHub Pages

on:
  push:
    branches:
      - main

jobs:
  deploy:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Setup deployment
        run: |
          mkdir -p build
          # Copy all necessary files and directories
          cp -r index.html build/
          cp -r js build/
          cp -r css build/
          cp -r images build/
          cp -r data build/
          
          # Create directories if they don't exist
          mkdir -p build/css
          mkdir -p build/images
          mkdir -p build/data
          
          # Debug: List contents
          echo "Build directory structure:"
          ls -R build/

      - name: Debug build contents
        run: |
          echo "Contents of build/data directory:"
          ls -la build/data || echo "data directory not found!"
          
          echo "Full build directory structure:"
          find build -type f

      - name: Deploy to GitHub Pages
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          folder: build
          branch: gh-pages
          clean: true

      - name: Verify deployment
        run: |
          echo "Verifying deployment..."
          echo "Checking for data files..."
          curl -I "https://iburchel.github.io/frontier-finder/data/existing_upgs_updated.csv" || true
          curl -I "https://iburchel.github.io/frontier-finder/data/updated_uupg.csv" || true
